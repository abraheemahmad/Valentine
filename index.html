<script>
// Track mouse
let mouse = {x:0, y:0};
document.addEventListener("mousemove", e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});

// Track NO button position
const noBtn = document.getElementById("noBtn");
const buttonsContainer = noBtn.parentElement;
let noPos = {
  x: 0,
  y: 0
};

function resetNoButtonPosition() {
  const rect = buttonsContainer.getBoundingClientRect();
  noPos.x = rect.right - noBtn.offsetWidth;
  noPos.y = rect.top + (rect.height - noBtn.offsetHeight)/2;
  noBtn.style.left = noPos.x + "px";
  noBtn.style.top = noPos.y + "px";
}

// Call reset on entering screen 2
document.getElementById("screen2").addEventListener("transitionend", resetNoButtonPosition);

// Smooth "magnet" movement
function moveNoButton() {
  const screen2 = document.getElementById("screen2");
  if (!screen2.classList.contains("active")) {
    requestAnimationFrame(moveNoButton);
    return; // only move when screen2 active
  }

  const rect = noBtn.getBoundingClientRect();
  const centerX = rect.left + rect.width/2;
  const centerY = rect.top + rect.height/2;
  const dx = mouse.x - centerX;
  const dy = mouse.y - centerY;
  const distance = Math.sqrt(dx*dx + dy*dy);

  if(distance < 120) {
    // smooth magnet nudge
    noPos.x -= dx / distance * 8;
    noPos.y -= dy / distance * 8;

    // keep in viewport
    noPos.x = Math.min(window.innerWidth - rect.width, Math.max(0, noPos.x));
    noPos.y = Math.min(window.innerHeight - rect.height, Math.max(0, noPos.y));

    noBtn.style.left = noPos.x + "px";
    noBtn.style.top = noPos.y + "px";
  }

  requestAnimationFrame(moveNoButton);
}

requestAnimationFrame(moveNoButton);
</script>
